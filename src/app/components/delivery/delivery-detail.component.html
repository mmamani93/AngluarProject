<form class="row form-horizontal" [formGroup]="deliveryForm" *ngIf="delivery" novalidate>
  <h3>Datos administrativos</h3>
  <hr>

  <div class="form-group">
    <div class="control-label col-sm-2 text-left">Nombre (*)</div>
    <div class="col-sm-2">
      <input [(ngModel)]="delivery.name" class="form-control" formControlName="name" maxlength="50">
    </div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('name', 'required')"> {{requiredErrorMessage}}</div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('name', 'pattern')"> {{formatErrorMessage}}</div>
  </div>

  <div class="form-group">
    <div class="control-label col-sm-2 text-left">Teléfono (*)</div>
    <div class="col-sm-2">
      <input [(ngModel)]="delivery.telephone" class="form-control" formControlName="telephone" maxlength="50">
    </div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('telephone', 'required')"> {{requiredErrorMessage}}</div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('telephone', 'pattern')"> {{formatErrorMessage}}</div>
  </div>

  <div class="form-group">
    <div class="control-label col-sm-2 text-left">Descripción (*)</div>
    <div class="col-sm-4">
      <textarea [(ngModel)]="delivery.description" class="form-control" rows="5" formControlName="description" maxlength="1000"
        (keyup)="descriptionKeyup(delivery.description)"></textarea>
    </div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('description', 'required')"> {{requiredErrorMessage}}</div>
    Restan {{descriptionAvailableCharacters}} caracteres.
  </div>

  <div class="form-group">
    <div class="control-label col-sm-2 text-left">Especialidades</div>
    <div class="col-sm-4">
      <textarea [(ngModel)]="delivery.specialities" class="form-control" rows="5" formControlName="specialities" maxlength="500"
        (keyup)="specialitiesKeyup(delivery.specialities)"></textarea>
    </div>
    Restan {{specialitiesAvailableCharacters}} caracteres.
  </div>

  <div class="form-group">
    <div class="control-label col-sm-2 text-left">Dirección (*)</div>
    <div class="col-sm-2">
      <input [(ngModel)]="delivery.address" class="form-control" formControlName="address" maxlength="200">
    </div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('address', 'required')"> {{requiredErrorMessage}}</div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('address', 'pattern')"> {{formatErrorMessage}}</div>
  </div>

  <div class="form-group">
    <div class="control-label col-sm-2 text-left">Horario de atención (*)</div>
    <div class="col-sm-1">
      <input [(ngModel)]="delivery.businessHourStart" class=" timepicker form-control" formControlName="businessHourStart" maxlength="50"
        atp-time-picker> 
    </div>
    <div class="col-sm-1">
      <input [(ngModel)]="delivery.businessHourEnd" class="form-control" formControlName="businessHourEnd" maxlength="50" atp-time-picker>
    </div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('businessHourStart', 'required') || !isValid('businessHourEnd', 'required')">
    {{requiredErrorMessage}}</div>
    <div class="col-sm-2 text-danger" *ngIf="!isValid('businessHourStart', 'pattern') || !isValid('businessHourEnd', 'pattern')">
    {{formatErrorMessage}}</div>
  </div>

  <!--CONTACTS-->

  <div class="row" *ngIf="delivery">
    <div class="col-md-6">
      <h3>Contacto Administrativo</h3>
      <hr>

      <div class="form-group">
        <div class="control-label col-sm-4 text-left">Nombre (*)</div>
        <div class="col-sm-4">
          <input [(ngModel)]="delivery.administrativeContact.name" formControlName="administrativeContactName" class="form-control"
            maxlength="200">
        </div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('administrativeContactName', 'required')"> {{requiredErrorMessage}}</div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('administrativeContactName', 'pattern')"> {{formatErrorMessage}}</div>
      </div>

      <div class="form-group">
        <div class="control-label col-sm-4 text-left">Apellido (*)</div>
        <div class="col-sm-4">
          <input [(ngModel)]="delivery.administrativeContact.lastname" formControlName="administrativeContactLastname" class="form-control"
            maxlength="200">
        </div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('administrativeContactLastname', 'required')"> {{requiredErrorMessage}}</div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('administrativeContactLastname', 'pattern')"> {{formatErrorMessage}}</div>
      </div>

      <div class="form-group">
        <div class="control-label col-sm-4 text-left">Teléfono (*)</div>
        <div class="col-sm-4">
          <input [(ngModel)]="delivery.administrativeContact.telephone" formControlName="administrativeContactTelephone" class="form-control"
            maxlength="100">
        </div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('administrativeContactTelephone', 'required')"> {{requiredErrorMessage}}</div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('administrativeContactTelephone', 'pattern')"> {{formatErrorMessage}}</div>
      </div>

      <div class="form-group">
        <div class="control-label col-sm-4 text-left">Email (*)</div>
        <div class="col-sm-4">
          <input [(ngModel)]="delivery.administrativeContact.email" formControlName="administrativeContactEmail" class="form-control"
            maxlength="100" type="email">
        </div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('administrativeContactEmail', 'required')"> {{requiredErrorMessage}}</div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('administrativeContactEmail', 'email')">El email ingresado es incorrecto</div>
      </div>
    </div>

    <!--COMMERCIAL CONTACT-->
    <div class="col-md-6">
      <h3>Contacto Comercial</h3>
      <hr>
      <div class="form-group">
        <div class="col-sm-1">
          <input type="checkbox" [(ngModel)]="delivery.commercialContact.idemContact" formControlName="commercialContactIdemContact">
        </div>
        <div class="control-label col-sm-4 text-left">Idem Contacto Administrativo</div>
      </div>

      <div class="form-group">
        <div class="control-label col-sm-4 text-left">Nombre</div>
        <div class="col-sm-4">
          <input [(ngModel)]="delivery.commercialContact.name" formControlName="commercialContactName" class="form-control" maxlength="200">
        </div>
        <div class="col-sm-4 text-danger" *ngIf="checkForIdemContact('commercialContactName')"> {{requiredErrorMessage}}</div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('commercialContactName', 'pattern')"> {{formatErrorMessage}}</div>
      </div>

      <div class="form-group">
        <div class="control-label col-sm-4 text-left">Apellido</div>
        <div class="col-sm-4">
          <input [(ngModel)]="delivery.commercialContact.lastname" formControlName="commercialContactLastname" class="form-control"
            maxlength="200">
        </div>
        <div class="col-sm-4 text-danger" *ngIf="checkForIdemContact('commercialContactLastname')"> {{requiredErrorMessage}}</div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('commercialContactLastname', 'pattern')"> {{formatErrorMessage}}</div>
      </div>

      <div class="form-group">
        <div class="control-label col-sm-4 text-left">Teléfono</div>
        <div class="col-sm-4">
          <input [(ngModel)]="delivery.commercialContact.telephone" formControlName="commercialContactTelephone" class="form-control"
            maxlength="100">
        </div>
        <div class="col-sm-4 text-danger" *ngIf="checkForIdemContact('commercialContactTelephone')"> {{requiredErrorMessage}}</div>
        <div class="col-sm-4 text-danger" *ngIf="!isValid('commercialContactTelephone', 'pattern')"> {{formatErrorMessage}}</div>
      </div>

      <div class="form-group">
        <div class="control-label col-sm-4 text-left">Email</div>
        <div class="col-sm-4">
          <input [(ngModel)]="delivery.commercialContact.email" formControlName="commercialContactEmail" class="form-control" maxlength="100">
        </div>
        <div class="col-sm-4 text-danger" *ngIf="checkForIdemContact('commercialContactEmail')"> {{requiredErrorMessage}}</div>
        <div class="col-sm-4 text-danger" *ngIf="!validEmail('commercialContactEmail')">El email ingresado es incorrecto</div>
      </div>

    </div>
  </div>
</form>

<div class="row margin-top">
  <div class="col-md-10">(*) Debe completar estos campos</div>
  <div class="col-md-2">
    <button class="btn btn-primary" (click)="goBack()">Cancelar</button>
    <button class="btn btn-primary" (click)="save()" [disabled]="!deliveryForm.valid">Guardar</button>
  </div>
</div>